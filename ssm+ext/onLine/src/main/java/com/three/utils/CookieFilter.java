package com.three.utils;import java.io.IOException;import java.text.SimpleDateFormat;import java.util.Calendar;import java.util.Date;import java.util.Locale;import javax.servlet.Filter;import javax.servlet.FilterChain;import javax.servlet.FilterConfig;import javax.servlet.ServletException;import javax.servlet.ServletRequest;import javax.servlet.ServletResponse;import javax.servlet.http.Cookie;import javax.servlet.http.HttpServletRequest;import javax.servlet.http.HttpServletResponse;/** *  一个Filter对Cookie进行处理 * @author Administrator * */public class CookieFilter implements Filter{		/**	 *重写dofilter 方法	 */	public void doFilter(ServletRequest servletRequest, ServletResponse servletResponse,              FilterChain chain) throws IOException, ServletException {  		HttpServletRequest request = (HttpServletRequest) servletRequest;		HttpServletResponse response = (HttpServletResponse) servletResponse;		Cookie[] cookies = request.getCookies();		if(cookies != null){			 Cookie cookie = cookies[0];               if (cookie != null) {                   /*cookie.setMaxAge(3600);                  cookie.setSecure(true);                  resp.addCookie(cookie);*/                                 	//Servlet 2.5不支持在Cookie上直接设置HttpOnly属性                   String value = cookie.getValue();                   StringBuilder builder = new StringBuilder();                   builder.append("JSESSIONID=" + value + "; ");                   builder.append("Secure; ");                   builder.append("HttpOnly; ");                   Calendar cal = Calendar.getInstance();                   cal.add(Calendar.HOUR, 1);                   Date date = cal.getTime();                   Locale locale = Locale.CHINA;                   SimpleDateFormat sdf =                            new SimpleDateFormat("dd-MM-yyyy HH:mm:ss",locale);                   builder.append("Expires=" + sdf.format(date));                   response.setHeader("Set-Cookie", builder.toString());               }       }       chain.doFilter(request, response);  	}			public void init(FilterConfig arg0) throws ServletException {  			}	public void destroy(){			}		}